<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EFOOTBALL SHOWDOWN</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;800&display=swap" rel="stylesheet">

<style>
body{
margin:0;font-family:Orbitron;background:#050814;color:#0ff;
display:flex;justify-content:center;align-items:center;height:100vh
}
.card{
background:#0a1030;padding:25px;border-radius:15px;
box-shadow:0 0 30px #00f7ff;width:320px;text-align:center
}
button,input{
width:100%;padding:10px;margin-top:10px;
border-radius:8px;border:none;font-weight:700
}
button{background:#00f7ff;color:#000;cursor:pointer}
.hidden{display:none}
</style>
</head>

<body>

<div class="card" id="login">
<h2>LOGIN</h2>
<input id="user" placeholder="Username">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<div class="card hidden" id="player">
<h2 id="pname"></h2>
<p>Points: <span id="points"></span></p>
<p>Status: <span id="status"></span></p>
</div>

<div class="card hidden" id="admin">
<h2>ADMIN PANEL</h2>
<button onclick="setPoints()">Set Player Points to 50</button>
</div>

<script>
const API = "http://localhost:4000";
const socket = io(API);
let token = "";

async function login(){
  const res = await fetch(API+"/login",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      username:user.value,
      password:pass.value
    })
  });
  const data = await res.json();
  token = data.token;
  loginDiv.style.display="none";

  if(data.role==="PLAYER"){
    playerDiv.style.display="block";
    socket.emit("online","player1");
    loadPlayer();
  } else {
    adminDiv.style.display="block";
  }
}

async function loadPlayer(){
  const res = await fetch(API+"/player",{
    headers:{Authorization:"Bearer "+token}
  });
  const d = await res.json();
  pname.innerText = d.name;
  points.innerText = d.points;
  status.innerText = d.status;
}

async function setPoints(){
  await fetch(API+"/admin/points",{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      Authorization:"Bearer "+token
    },
    body:JSON.stringify({playerId:"player1",points:50})
  });
}

socket.on("pointsUpdated", data=>{
  if(data.player1) points.innerText=data.player1.points;
});
</script>

</body>
</html>
