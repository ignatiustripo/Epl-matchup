<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>eFootball Tournament Manager - Admin Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary: #3b82f6;
  --secondary: #22d3ee;
  --success: #10b981;
  --danger: #ef4444;
  --warning: #f59e0b;
  --dark: #020617;
  --darker: #0f172a;
  --light: #f8fafc;
  --admin-blue: #1e40af;
  --admin-purple: #7c3aed;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: var(--light);
  min-height: 100vh;
}

/* Admin Header */
.admin-header {
  background: linear-gradient(135deg, var(--admin-blue) 0%, var(--admin-purple) 100%);
  color: white;
  padding: 1rem 2rem;
  box-shadow: 0 4px 30px rgba(30, 64, 175, 0.3);
  position: sticky;
  top: 0;
  z-index: 1000;
}

.admin-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 1400px;
  margin: 0 auto;
}

.admin-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 1.5rem;
  font-weight: 700;
}

.admin-nav-links {
  display: flex;
  gap: 1.5rem;
  align-items: center;
}

.admin-nav-link {
  color: rgba(255, 255, 255, 0.9);
  text-decoration: none;
  font-weight: 600;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.admin-nav-link:hover {
  background: rgba(255, 255, 255, 0.15);
  color: white;
}

.admin-badge {
  background: var(--danger);
  color: white;
  padding: 0.3rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 700;
}

/* Admin Container */
.admin-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
}

/* Admin Cards */
.admin-card {
  background: rgba(15, 23, 42, 0.95);
  border: 2px solid rgba(34, 211, 238, 0.2);
  border-radius: 16px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(10px);
}

.admin-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid rgba(34, 211, 238, 0.3);
}

.admin-card-title {
  color: var(--secondary);
  font-size: 1.5rem;
  font-weight: 700;
}

/* Grid System */
.admin-grid {
  display: grid;
  gap: 1.5rem;
}

.grid-2 { grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
.grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
.grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

/* Admin Stats */
.admin-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.admin-stat {
  background: rgba(2, 6, 23, 0.6);
  border-radius: 12px;
  padding: 1.2rem;
  text-align: center;
  border: 1px solid rgba(34, 211, 238, 0.1);
}

.admin-stat-value {
  font-size: 2.5rem;
  font-weight: 800;
  color: var(--secondary);
  line-height: 1;
  margin-bottom: 0.5rem;
}

.admin-stat-label {
  color: #94a3b8;
  font-size: 0.9rem;
}

/* Admin Tables */
.admin-table-container {
  overflow-x: auto;
  border-radius: 12px;
  border: 1px solid rgba(34, 211, 238, 0.2);
  margin-top: 1rem;
}

.admin-table {
  width: 100%;
  border-collapse: collapse;
  min-width: 1000px;
  background: rgba(2, 6, 23, 0.8);
}

.admin-table th {
  background: rgba(30, 64, 175, 0.8);
  padding: 1rem;
  text-align: center;
  color: white;
  font-weight: 700;
  border-bottom: 2px solid rgba(34, 211, 238, 0.3);
}

.admin-table td {
  padding: 1rem;
  text-align: center;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.admin-table tr:hover {
  background: rgba(34, 211, 238, 0.05);
}

/* Buttons */
.admin-btn {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  border: none;
  color: white;
  font-weight: 600;
  padding: 0.8rem 1.5rem;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 0.95rem;
}

.admin-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(34, 211, 238, 0.3);
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger), #dc2626);
}

.btn-warning {
  background: linear-gradient(135deg, var(--warning), #eab308);
}

.btn-success {
  background: linear-gradient(135deg, var(--success), #16a34a);
}

.btn-secondary {
  background: rgba(34, 211, 238, 0.1);
  color: var(--secondary);
  border: 1px solid var(--secondary);
}

/* Forms */
.admin-form-group {
  margin-bottom: 1.2rem;
}

.admin-form-label {
  display: block;
  margin-bottom: 0.5rem;
  color: var(--secondary);
  font-weight: 600;
  font-size: 0.9rem;
}

.admin-form-control {
  width: 100%;
  padding: 0.8rem 1rem;
  background: rgba(2, 6, 23, 0.8);
  border: 2px solid #334155;
  border-radius: 10px;
  color: white;
  font-size: 1rem;
  transition: all 0.3s;
}

.admin-form-control:focus {
  outline: none;
  border-color: var(--secondary);
  box-shadow: 0 0 0 3px rgba(34, 211, 238, 0.1);
}

/* Modal */
.admin-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  padding: 1rem;
}

.admin-modal-content {
  background: rgba(15, 23, 42, 0.95);
  border-radius: 16px;
  padding: 2rem;
  width: 100%;
  max-width: 500px;
  border: 2px solid var(--secondary);
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

/* Tabs */
.admin-tabs {
  display: flex;
  gap: 0;
  border-bottom: 2px solid rgba(34, 211, 238, 0.3);
  margin-bottom: 1.5rem;
}

.admin-tab {
  padding: 1rem 1.5rem;
  background: none;
  border: none;
  color: #94a3b8;
  font-weight: 600;
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all 0.3s;
}

.admin-tab:hover {
  color: var(--secondary);
}

.admin-tab.active {
  color: var(--secondary);
  border-bottom-color: var(--secondary);
  background: rgba(34, 211, 238, 0.05);
}

/* Badges */
.admin-badge {
  display: inline-block;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 700;
}

.badge-success { background: var(--success); color: white; }
.badge-warning { background: var(--warning); color: #020617; }
.badge-danger { background: var(--danger); color: white; }
.badge-info { background: var(--secondary); color: #020617; }

/* Utilities */
.hidden { display: none !important; }
.text-center { text-align: center; }
.mt-2 { margin-top: 0.5rem; }
.mt-4 { margin-top: 1rem; }
.mb-2 { margin-bottom: 0.5rem; }
.mb-4 { margin-bottom: 1rem; }
.d-flex { display: flex; }
.align-center { align-items: center; }
.justify-between { justify-content: space-between; }
.gap-2 { gap: 0.5rem; }
.w-100 { width: 100%; }

/* Responsive */
@media (max-width: 768px) {
  .admin-container { padding: 1rem; }
  .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
  .admin-nav { flex-direction: column; gap: 1rem; }
  .admin-nav-links { flex-wrap: wrap; justify-content: center; }
  .admin-tabs { overflow-x: auto; }
  .admin-tab { padding: 0.8rem 1rem; font-size: 0.9rem; }
}
</style>
</head>
<body>
<!-- Admin Login Section -->
<div id="adminLoginSection" class="admin-modal">
  <div class="admin-modal-content">
    <div class="text-center mb-4">
      <i class="fas fa-lock" style="font-size: 3rem; color: var(--secondary); margin-bottom: 1rem;"></i>
      <h2 style="color: var(--secondary);">Admin Login</h2>
      <p style="color: #94a3b8;">Enter admin password to access control panel</p>
    </div>
    
    <div class="admin-form-group">
      <input type="password" id="adminPassword" class="admin-form-control" placeholder="Enter admin password" autocomplete="off">
    </div>
    
    <div id="loginError" class="text-center mb-4 hidden" style="color: var(--danger);">
      <i class="fas fa-exclamation-circle"></i> Invalid password
    </div>
    
    <button class="admin-btn w-100" onclick="adminLogin()">
      <i class="fas fa-sign-in-alt"></i> Login
    </button>
    
    <div class="text-center mt-4" style="color: #94a3b8; font-size: 0.9rem;">
      <i class="fas fa-info-circle"></i> Default password: admin12
    </div>
  </div>
</div>

<!-- Main Admin Panel -->
<div id="adminPanel" class="hidden">
  <!-- Admin Header -->
  <header class="admin-header">
    <div class="admin-nav">
      <div class="admin-logo">
        <i class="fas fa-crown"></i>
        <span>Admin Control Panel</span>
      </div>
      
      <div class="admin-nav-links">
        <a href="#" class="admin-nav-link" onclick="showTab('dashboard')">
          <i class="fas fa-tachometer-alt"></i> Dashboard
        </a>
        <a href="#" class="admin-nav-link" onclick="showTab('tournaments')">
          <i class="fas fa-trophy"></i> Tournaments
        </a>
        <a href="#" class="admin-nav-link" onclick="showTab('teams')">
          <i class="fas fa-users"></i> Teams
        </a>
        <a href="#" class="admin-nav-link" onclick="showTab('players')">
          <i class="fas fa-user"></i> Players
        </a>
        <a href="#" class="admin-nav-link" onclick="showTab('matches')">
          <i class="fas fa-futbol"></i> Matches
        </a>
        <a href="#" class="admin-nav-link" onclick="showTab('points')">
          <i class="fas fa-chart-line"></i> Points
        </a>
        <div class="admin-badge badge-danger">
          <i class="fas fa-shield-alt"></i> ADMIN
        </div>
        <button class="admin-btn btn-danger" onclick="adminLogout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  </header>

  <!-- Admin Container -->
  <div class="admin-container">
    <!-- Dashboard Tab -->
    <div id="dashboardTab" class="admin-tab-content">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">System Overview</h2>
          <button class="admin-btn btn-success" onclick="refreshStats()">
            <i class="fas fa-sync-alt"></i> Refresh
          </button>
        </div>
        
        <div class="admin-stats">
          <div class="admin-stat">
            <div class="admin-stat-value" id="totalTournaments">0</div>
            <div class="admin-stat-label">Tournaments</div>
          </div>
          <div class="admin-stat">
            <div class="admin-stat-value" id="totalTeams">0</div>
            <div class="admin-stat-label">Teams</div>
          </div>
          <div class="admin-stat">
            <div class="admin-stat-value" id="totalPlayers">0</div>
            <div class="admin-stat-label">Players</div>
          </div>
          <div class="admin-stat">
            <div class="admin-stat-value" id="totalMatches">0</div>
            <div class="admin-stat-label">Matches</div>
          </div>
          <div class="admin-stat">
            <div class="admin-stat-value" id="liveMatches">0</div>
            <div class="admin-stat-label">Live Matches</div>
          </div>
          <div class="admin-stat">
            <div class="admin-stat-value" id="activeUsers">0</div>
            <div class="admin-stat-label">Active Users</div>
          </div>
        </div>
        
        <div class="admin-grid grid-2 mt-4">
          <!-- Recent Activity -->
          <div class="admin-card">
            <h3 class="admin-card-title">Recent Activity</h3>
            <div id="recentActivity">
              <!-- Activity logs will be added here -->
            </div>
          </div>
          
          <!-- Quick Actions -->
          <div class="admin-card">
            <h3 class="admin-card-title">Quick Actions</h3>
            <div class="d-flex flex-column gap-2">
              <button class="admin-btn" onclick="showTab('tournaments')">
                <i class="fas fa-plus"></i> Create Tournament
              </button>
              <button class="admin-btn btn-success" onclick="showTab('teams')">
                <i class="fas fa-user-plus"></i> Add Team
              </button>
              <button class="admin-btn btn-warning" onclick="showTab('matches')">
                <i class="fas fa-calendar-plus"></i> Schedule Match
              </button>
              <button class="admin-btn btn-danger" onclick="resetSystem()">
                <i class="fas fa-trash-alt"></i> Reset System
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tournaments Tab -->
    <div id="tournamentsTab" class="admin-tab-content hidden">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">Tournament Management</h2>
          <button class="admin-btn" onclick="showCreateTournamentModal()">
            <i class="fas fa-plus"></i> Create Tournament
          </button>
        </div>

        <!-- Create Tournament Modal -->
        <div id="createTournamentModal" class="hidden mt-4">
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Tournament Name</label>
              <input type="text" id="tournamentName" class="admin-form-control" placeholder="Premier League 2024">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Type</label>
              <select id="tournamentType" class="admin-form-control" onchange="updateTournamentOptions()">
                <option value="league">League (EPL Style)</option>
                <option value="champions">Champions League</option>
                <option value="worldcup">World Cup</option>
              </select>
            </div>
          </div>

          <div class="admin-grid grid-3">
            <div class="admin-form-group">
              <label class="admin-form-label">Number of Teams</label>
              <input type="number" id="tournamentTeams" class="admin-form-control" value="20" min="4" max="32">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Fixture Generation</label>
              <select id="fixtureGeneration" class="admin-form-control">
                <option value="auto">Auto Generate</option>
                <option value="manual">Manual</option>
                <option value="semi">Semi-Auto</option>
              </select>
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">
                <input type="checkbox" id="homeAway" checked> Home & Away
              </label>
            </div>
          </div>

          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="createTournament()">
              <i class="fas fa-check"></i> Create
            </button>
            <button class="admin-btn btn-secondary" onclick="hideCreateTournamentModal()">
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>

        <!-- Tournaments List -->
        <div class="admin-table-container mt-4">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Type</th>
                <th>Status</th>
                <th>Teams</th>
                <th>Matches</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="tournamentsList">
              <!-- Tournaments will be added here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Teams Tab -->
    <div id="teamsTab" class="admin-tab-content hidden">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">Team Management</h2>
          <button class="admin-btn" onclick="showAddTeamModal()">
            <i class="fas fa-plus"></i> Add Team
          </button>
        </div>

        <!-- Add Team Modal -->
        <div id="addTeamModal" class="hidden mt-4">
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Team Name</label>
              <input type="text" id="newTeamName" class="admin-form-control" placeholder="Enter team name">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Short Code</label>
              <input type="text" id="teamShortCode" class="admin-form-control" placeholder="e.g., ARS" maxlength="3">
            </div>
          </div>
          
          <div class="admin-form-group">
            <label class="admin-form-label">Team Color</label>
            <input type="color" id="teamColor" class="admin-form-control" value="#3b82f6">
          </div>
          
          <div class="admin-form-group">
            <label class="admin-form-label">Tournament</label>
            <select id="teamTournament" class="admin-form-control">
              <option value="">Select Tournament</option>
            </select>
          </div>
          
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="addTeam()">
              <i class="fas fa-check"></i> Add Team
            </button>
            <button class="admin-btn btn-secondary" onclick="hideAddTeamModal()">
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>

        <!-- Teams List -->
        <div class="admin-table-container mt-4">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Short Code</th>
                <th>Tournament</th>
                <th>P</th>
                <th>W</th>
                <th>D</th>
                <th>L</th>
                <th>GD</th>
                <th>PTS</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="teamsList">
              <!-- Teams will be added here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Players Tab -->
    <div id="playersTab" class="admin-tab-content hidden">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">Player Management</h2>
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="showAddPlayerModal()">
              <i class="fas fa-user-plus"></i> Add Player
            </button>
            <button class="admin-btn btn-success" onclick="generateRegistrationLink()">
              <i class="fas fa-link"></i> Generate Link
            </button>
          </div>
        </div>

        <!-- Add Player Modal -->
        <div id="addPlayerModal" class="hidden mt-4">
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Player Name</label>
              <input type="text" id="newPlayerName" class="admin-form-control" placeholder="Enter player name">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Email</label>
              <input type="email" id="playerEmail" class="admin-form-control" placeholder="player@email.com">
            </div>
          </div>
          
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Team</label>
              <select id="playerTeam" class="admin-form-control">
                <option value="">Select Team</option>
              </select>
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Position</label>
              <select id="playerPosition" class="admin-form-control">
                <option value="forward">Forward</option>
                <option value="midfielder">Midfielder</option>
                <option value="defender">Defender</option>
                <option value="goalkeeper">Goalkeeper</option>
              </select>
            </div>
          </div>
          
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="addPlayer()">
              <i class="fas fa-check"></i> Add Player
            </button>
            <button class="admin-btn btn-secondary" onclick="hideAddPlayerModal()">
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>

        <!-- Registration Link -->
        <div id="registrationLinkModal" class="hidden mt-4">
          <div class="admin-card">
            <h3 class="admin-card-title">Registration Link</h3>
            <div class="admin-form-group">
              <label class="admin-form-label">Copy this link to share with players:</label>
              <div class="d-flex gap-2">
                <input type="text" id="regLink" class="admin-form-control" readonly>
                <button class="admin-btn" onclick="copyRegistrationLink()">
                  <i class="fas fa-copy"></i> Copy
                </button>
              </div>
            </div>
            <button class="admin-btn btn-secondary" onclick="hideRegistrationLink()">
              <i class="fas fa-times"></i> Close
            </button>
          </div>
        </div>

        <!-- Players List -->
        <div class="admin-table-container mt-4">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Team</th>
                <th>Position</th>
                <th>Matches</th>
                <th>Goals</th>
                <th>Rating</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="playersList">
              <!-- Players will be added here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Matches Tab -->
    <div id="matchesTab" class="admin-tab-content hidden">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">Match Management</h2>
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="showScheduleMatchModal()">
              <i class="fas fa-calendar-plus"></i> Schedule Match
            </button>
            <button class="admin-btn btn-success" onclick="generateFixtures()">
              <i class="fas fa-bolt"></i> Generate Fixtures
            </button>
          </div>
        </div>

        <!-- Schedule Match Modal -->
        <div id="scheduleMatchModal" class="hidden mt-4">
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Home Team</label>
              <select id="homeTeamSelect" class="admin-form-control">
                <option value="">Select Home Team</option>
              </select>
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Away Team</label>
              <select id="awayTeamSelect" class="admin-form-control">
                <option value="">Select Away Team</option>
              </select>
            </div>
          </div>
          
          <div class="admin-grid grid-2">
            <div class="admin-form-group">
              <label class="admin-form-label">Date</label>
              <input type="date" id="matchDate" class="admin-form-control">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Time</label>
              <input type="time" id="matchTime" class="admin-form-control">
            </div>
          </div>
          
          <div class="admin-form-group">
            <label class="admin-form-label">Venue</label>
            <input type="text" id="matchVenue" class="admin-form-control" placeholder="Stadium name">
          </div>
          
          <div class="admin-form-group">
            <label class="admin-form-label">Tournament</label>
            <select id="matchTournament" class="admin-form-control" onchange="loadTeamsForMatch()">
              <option value="">Select Tournament</option>
            </select>
          </div>
          
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="scheduleMatch()">
              <i class="fas fa-check"></i> Schedule
            </button>
            <button class="admin-btn btn-secondary" onclick="hideScheduleMatchModal()">
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>

        <!-- Matches Tabs -->
        <div class="admin-tabs">
          <button class="admin-tab active" onclick="showMatchType('upcoming')">Upcoming</button>
          <button class="admin-tab" onclick="showMatchType('live')">Live</button>
          <button class="admin-tab" onclick="showMatchType('completed')">Completed</button>
          <button class="admin-tab" onclick="showMatchType('all')">All Matches</button>
        </div>

        <!-- Matches List -->
        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Match</th>
                <th>Date</th>
                <th>Venue</th>
                <th>Status</th>
                <th>Score</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="matchesList">
              <!-- Matches will be added here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Points Tab -->
    <div id="pointsTab" class="admin-tab-content hidden">
      <div class="admin-card">
        <div class="admin-card-header">
          <h2 class="admin-card-title">Points Allocation</h2>
          <select id="pointsTournament" class="admin-form-control" style="width: auto;" onchange="loadPointsTable()">
            <option value="">Select Tournament</option>
          </select>
        </div>

        <!-- Points Table -->
        <div class="admin-table-container mt-4">
          <table class="admin-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Team</th>
                <th>P</th>
                <th>W</th>
                <th>D</th>
                <th>L</th>
                <th>GF</th>
                <th>GA</th>
                <th>GD</th>
                <th>PTS</th>
                <th>Adjust Points</th>
              </tr>
            </thead>
            <tbody id="pointsTable">
              <!-- Points table will be added here -->
            </tbody>
          </table>
        </div>

        <!-- Manual Points Adjustment -->
        <div class="admin-card mt-4">
          <h3 class="admin-card-title">Manual Points Adjustment</h3>
          <div class="admin-grid grid-3">
            <div class="admin-form-group">
              <label class="admin-form-label">Select Team</label>
              <select id="adjustTeam" class="admin-form-control">
                <option value="">Select Team</option>
              </select>
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Points to Add/Remove</label>
              <input type="number" id="adjustPoints" class="admin-form-control" value="0" min="-10" max="10">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Adjust Goals For</label>
              <input type="number" id="adjustGF" class="admin-form-control" value="0" min="-10" max="10">
            </div>
          </div>
          
          <div class="admin-grid grid-3">
            <div class="admin-form-group">
              <label class="admin-form-label">Adjust Wins</label>
              <input type="number" id="adjustWins" class="admin-form-control" value="0" min="-5" max="5">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Adjust Draws</label>
              <input type="number" id="adjustDraws" class="admin-form-control" value="0" min="-5" max="5">
            </div>
            <div class="admin-form-group">
              <label class="admin-form-label">Adjust Losses</label>
              <input type="number" id="adjustLosses" class="admin-form-control" value="0" min="-5" max="5">
            </div>
          </div>
          
          <div class="d-flex gap-2">
            <button class="admin-btn" onclick="adjustTeamStats()">
              <i class="fas fa-check"></i> Apply Adjustment
            </button>
            <button class="admin-btn btn-secondary" onclick="resetAdjustment()">
              <i class="fas fa-redo"></i> Reset
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Edit Match Modal -->
<div id="editMatchModal" class="admin-modal hidden">
  <div class="admin-modal-content">
    <h2 class="admin-card-title">Edit Match Result</h2>
    
    <div class="admin-form-group">
      <label class="admin-form-label">Home Score</label>
      <input type="number" id="editHomeScore" class="admin-form-control" min="0" value="0">
    </div>
    
    <div class="admin-form-group">
      <label class="admin-form-label">Away Score</label>
      <input type="number" id="editAwayScore" class="admin-form-control" min="0" value="0">
    </div>
    
    <div class="admin-form-group">
      <label class="admin-form-label">Status</label>
      <select id="editMatchStatus" class="admin-form-control">
        <option value="scheduled">Scheduled</option>
        <option value="live">Live</option>
        <option value="completed">Completed</option>
        <option value="postponed">Postponed</option>
        <option value="cancelled">Cancelled</option>
      </select>
    </div>
    
    <div class="d-flex gap-2">
      <button class="admin-btn" onclick="saveMatchResult()">
        <i class="fas fa-save"></i> Save
      </button>
      <button class="admin-btn btn-secondary" onclick="closeEditModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="admin-btn btn-danger" onclick="deleteMatch()">
        <i class="fas fa-trash"></i> Delete
      </button>
    </div>
    
    <div id="matchEditError" class="text-center mt-4 hidden" style="color: var(--danger);"></div>
  </div>
</div>

<script>
// Admin Password Encryption
const ADMIN_PASSWORD = "admin12";
let currentEditingMatchId = null;

// Data Storage
let adminData = {
  tournaments: JSON.parse(localStorage.getItem('admin_tournaments')) || [],
  teams: JSON.parse(localStorage.getItem('admin_teams')) || [],
  players: JSON.parse(localStorage.getItem('admin_players')) || [],
  matches: JSON.parse(localStorage.getItem('admin_matches')) || [],
  activityLog: JSON.parse(localStorage.getItem('admin_activity')) || [],
  users: JSON.parse(localStorage.getItem('admin_users')) || [],
  settings: JSON.parse(localStorage.getItem('admin_settings')) || {
    adminPassword: ADMIN_PASSWORD,
    registrationOpen: true,
    maxTeams: 32,
    maxPlayersPerTeam: 25
  }
};

// Initialize
function init() {
  if (adminData.tournaments.length === 0) {
    createSampleData();
  }
  updateStats();
  logActivity('System initialized', 'info');
}

// Save data to localStorage
function saveData() {
  localStorage.setItem('admin_tournaments', JSON.stringify(adminData.tournaments));
  localStorage.setItem('admin_teams', JSON.stringify(adminData.teams));
  localStorage.setItem('admin_players', JSON.stringify(adminData.players));
  localStorage.setItem('admin_matches', JSON.stringify(adminData.matches));
  localStorage.setItem('admin_activity', JSON.stringify(adminData.activityLog));
  localStorage.setItem('admin_users', JSON.stringify(adminData.users));
  localStorage.setItem('admin_settings', JSON.stringify(adminData.settings));
}

// Log activity
function logActivity(message, type = 'info') {
  const activity = {
    id: Date.now(),
    message,
    type,
    timestamp: new Date().toISOString(),
    user: 'admin'
  };
  adminData.activityLog.unshift(activity);
  if (adminData.activityLog.length > 100) adminData.activityLog.pop();
  saveData();
  updateActivityLog();
}

// Admin Login
function adminLogin() {
  const password = document.getElementById('adminPassword').value;
  const errorDiv = document.getElementById('loginError');
  
  if (password === adminData.settings.adminPassword) {
    // Successful login
    document.getElementById('adminLoginSection').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
    document.getElementById('adminPassword').value = '';
    errorDiv.classList.add('hidden');
    
    // Load data
    loadTournaments();
    loadTeams();
    loadPlayers();
    loadMatches();
    updateStats();
    logActivity('Admin logged in', 'success');
    
    // Show dashboard
    showTab('dashboard');
  } else {
    errorDiv.classList.remove('hidden');
    logActivity('Failed login attempt', 'error');
  }
}

// Admin Logout
function adminLogout() {
  document.getElementById('adminLoginSection').classList.remove('hidden');
  document.getElementById('adminPanel').classList.add('hidden');
  logActivity('Admin logged out', 'info');
}

// Tab Navigation
function showTab(tabName) {
  // Hide all tabs
  document.querySelectorAll('.admin-tab-content').forEach(tab => {
    tab.classList.add('hidden');
  });
  
  // Show selected tab
  document.getElementById(tabName + 'Tab').classList.remove('hidden');
  
  // Update content based on tab
  switch(tabName) {
    case 'dashboard':
      updateStats();
      updateActivityLog();
      break;
    case 'tournaments':
      loadTournaments();
      break;
    case 'teams':
      loadTeams();
      populateTournamentSelect('teamTournament');
      break;
    case 'players':
      loadPlayers();
      populateTeamsSelect('playerTeam');
      break;
    case 'matches':
      loadMatches();
      populateTournamentSelect('matchTournament');
      break;
    case 'points':
      loadPointsTable();
      populateTournamentSelect('pointsTournament');
      populateTeamsSelect('adjustTeam');
      break;
  }
}

// Update Statistics
function updateStats() {
  document.getElementById('totalTournaments').textContent = adminData.tournaments.length;
  document.getElementById('totalTeams').textContent = adminData.teams.length;
  document.getElementById('totalPlayers').textContent = adminData.players.length;
  document.getElementById('totalMatches').textContent = adminData.matches.length;
  document.getElementById('liveMatches').textContent = adminData.matches.filter(m => m.status === 'live').length;
  document.getElementById('activeUsers').textContent = adminData.users.length;
}

// Update Activity Log
function updateActivityLog() {
  const container = document.getElementById('recentActivity');
  container.innerHTML = adminData.activityLog.slice(0, 10).map(activity => {
    const icon = activity.type === 'success' ? 'fa-check-circle' : 
                 activity.type === 'error' ? 'fa-exclamation-circle' : 
                 activity.type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
    const color = activity.type === 'success' ? 'var(--success)' : 
                  activity.type === 'error' ? 'var(--danger)' : 
                  activity.type === 'warning' ? 'var(--warning)' : 'var(--secondary)';
    
    return `
      <div class="d-flex align-center gap-2 mb-2">
        <i class="fas ${icon}" style="color: ${color};"></i>
        <span style="color: #94a3b8; font-size: 0.9rem;">${activity.message}</span>
        <span style="color: #64748b; font-size: 0.8rem; margin-left: auto;">
          ${new Date(activity.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
        </span>
      </div>
    `;
  }).join('');
}

// Tournament Management
function showCreateTournamentModal() {
  document.getElementById('createTournamentModal').classList.remove('hidden');
}

function hideCreateTournamentModal() {
  document.getElementById('createTournamentModal').classList.add('hidden');
}

function createTournament() {
  const name = document.getElementById('tournamentName').value;
  const type = document.getElementById('tournamentType').value;
  const teams = parseInt(document.getElementById('tournamentTeams').value);
  const fixtureGen = document.getElementById('fixtureGeneration').value;
  const homeAway = document.getElementById('homeAway').checked;
  
  if (!name) {
    alert('Please enter tournament name');
    return;
  }
  
  const tournament = {
    id: Date.now(),
    name,
    type,
    status: 'upcoming',
    currentRound: 1,
    teams: [],
    matches: [],
    settings: {
      totalTeams: teams,
      fixtureGen,
      homeAndAway: homeAway,
      pointsPerWin: 3,
      pointsPerDraw: 1,
      pointsPerLoss: 0
    },
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString()
  };
  
  adminData.tournaments.push(tournament);
  saveData();
  loadTournaments();
  hideCreateTournamentModal();
  logActivity(`Created tournament: ${name}`, 'success');
  
  // Clear form
  document.getElementById('tournamentName').value = '';
}

function loadTournaments() {
  const container = document.getElementById('tournamentsList');
  container.innerHTML = adminData.tournaments.map(tournament => {
    const teams = adminData.teams.filter(t => t.tournamentId === tournament.id);
    const matches = adminData.matches.filter(m => m.tournamentId === tournament.id);
    
    return `
      <tr>
        <td>${tournament.id}</td>
        <td><strong>${tournament.name}</strong></td>
        <td><span class="admin-badge badge-info">${tournament.type}</span></td>
        <td><span class="admin-badge badge-${tournament.status === 'ongoing' ? 'success' : 'warning'}">${tournament.status}</span></td>
        <td>${teams.length}/${tournament.settings.totalTeams}</td>
        <td>${matches.length}</td>
        <td>
          <button class="admin-btn" onclick="manageTournament(${tournament.id})">
            <i class="fas fa-edit"></i>
          </button>
          <button class="admin-btn btn-danger" onclick="deleteTournament(${tournament.id})">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    `;
  }).join('');
}

// Team Management
function showAddTeamModal() {
  document.getElementById('addTeamModal').classList.remove('hidden');
}

function hideAddTeamModal() {
  document.getElementById('addTeamModal').classList.add('hidden');
}

function addTeam() {
  const name = document.getElementById('newTeamName').value;
  const shortCode = document.getElementById('teamShortCode').value.toUpperCase();
  const color = document.getElementById('teamColor').value;
  const tournamentId = document.getElementById('teamTournament').value;
  
  if (!name || !shortCode || !tournamentId) {
    alert('Please fill all required fields');
    return;
  }
  
  const team = {
    id: Date.now(),
    name,
    shortCode,
    color,
    tournamentId: parseInt(tournamentId),
    stats: {
      played: 0,
      won: 0,
      drawn: 0,
      lost: 0,
      goalsFor: 0,
      goalsAgainst: 0,
      points: 0
    },
    players: [],
    createdAt: new Date().toISOString()
  };
  
  adminData.teams.push(team);
  saveData();
  loadTeams();
  hideAddTeamModal();
  logActivity(`Added team: ${name}`, 'success');
  
  // Clear form
  document.getElementById('newTeamName').value = '';
  document.getElementById('teamShortCode').value = '';
}

function loadTeams() {
  const container = document.getElementById('teamsList');
  container.innerHTML = adminData.teams.map(team => {
    const tournament = adminData.tournaments.find(t => t.id === team.tournamentId);
    
    return `
      <tr>
        <td>${team.id}</td>
        <td>
          <div class="d-flex align-center gap-2">
            <div style="width: 20px; height: 20px; background: ${team.color}; border-radius: 4px;"></div>
            <strong>${team.name}</strong>
          </div>
        </td>
        <td>${team.shortCode}</td>
        <td>${tournament ? tournament.name : 'N/A'}</td>
        <td>${team.stats.played}</td>
        <td>${team.stats.won}</td>
        <td>${team.stats.drawn}</td>
        <td>${team.stats.lost}</td>
        <td>${team.stats.goalsFor - team.stats.goalsAgainst}</td>
        <td><strong>${team.stats.points}</strong></td>
        <td>
          <button class="admin-btn" onclick="editTeam(${team.id})">
            <i class="fas fa-edit"></i>
          </button>
          <button class="admin-btn btn-danger" onclick="deleteTeam(${team.id})">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    `;
  }).join('');
}

// Player Management
function showAddPlayerModal() {
  document.getElementById('addPlayerModal').classList.remove('hidden');
}

function hideAddPlayerModal() {
  document.getElementById('addPlayerModal').classList.add('hidden');
}

function addPlayer() {
  const name = document.getElementById('newPlayerName').value;
  const email = document.getElementById('playerEmail').value;
  const teamId = document.getElementById('playerTeam').value;
  const position = document.getElementById('playerPosition').value;
  
  if (!name || !email || !teamId) {
    alert('Please fill all required fields');
    return;
  }
  
  const player = {
    id: Date.now(),
    name,
    email,
    teamId: parseInt(teamId),
    position,
    stats: {
      matches: 0,
      goals: 0,
      assists: 0,
      yellowCards: 0,
      redCards: 0
    },
    rating: 6.0,
    status: 'active',
    joinedAt: new Date().toISOString()
  };
  
  adminData.players.push(player);
  saveData();
  loadPlayers();
  hideAddPlayerModal();
  logActivity(`Added player: ${name}`, 'success');
  
  // Clear form
  document.getElementById('newPlayerName').value = '';
  document.getElementById('playerEmail').value = '';
}

function loadPlayers() {
  const container = document.getElementById('playersList');
  container.innerHTML = adminData.players.map(player => {
    const team = adminData.teams.find(t => t.id === player.teamId);
    
    return `
      <tr>
        <td>${player.id}</td>
        <td><strong>${player.name}</strong></td>
        <td>${player.email}</td>
        <td>${team ? team.name : 'N/A'}</td>
        <td>${player.position}</td>
        <td>${player.stats.matches}</td>
        <td>${player.stats.goals}</td>
        <td>${player.rating.toFixed(1)}</td>
        <td>
          <button class="admin-btn" onclick="editPlayer(${player.id})">
            <i class="fas fa-edit"></i>
          </button>
          <button class="admin-btn btn-danger" onclick="deletePlayer(${player.id})">
            <i class="fas fa-trash"></i>
          </button>
        </td>
      </tr>
    `;
  }).join('');
}

// Match Management
function showScheduleMatchModal() {
  document.getElementById('scheduleMatchModal').classList.remove('hidden');
}

function hideScheduleMatchModal() {
  document.getElementById('scheduleMatchModal').classList.add('hidden');
}

function loadTeamsForMatch() {
  const tournamentId = document.getElementById('matchTournament').value;
  const teams = adminData.teams.filter(t => t.tournamentId === parseInt(tournamentId));
  
  const homeSelect = document.getElementById('homeTeamSelect');
  const awaySelect = document.getElementById('awayTeamSelect');
  
  homeSelect.innerHTML = '<option value="">Select Home Team</option>';
  awaySelect.innerHTML = '<option value="">Select Away Team</option>';
  
  teams.forEach(team => {
    homeSelect.innerHTML += `<option value="${team.id}">${team.name}</option>`;
    awaySelect.innerHTML += `<option value="${team.id}">${team.name}</option>`;
  });
}

function scheduleMatch() {
  const homeTeamId = document.getElementById('homeTeamSelect').value;
  const awayTeamId = document.getElementById('awayTeamSelect').value;
  const date = document.getElementById('matchDate').value;
  const time = document.getElementById('matchTime').value;
  const venue = document.getElementById('matchVenue').value;
  const tournamentId = document.getElementById('matchTournament').value;
  
  if (!homeTeamId || !awayTeamId || !date || !time || !venue || !tournamentId) {
    alert('Please fill all fields');
    return;
  }
  
  if (homeTeamId === awayTeamId) {
    alert('Home and away teams cannot be the same');
    return;
  }
  
  const match = {
    id: Date.now(),
    tournamentId: parseInt(tournamentId),
    homeTeamId: parseInt(homeTeamId),
    awayTeamId: parseInt(awayTeamId),
    date,
    time,
    venue,
    status: 'scheduled',
    homeScore: 0,
    awayScore: 0,
    round: 1,
    createdAt: new Date().toISOString()
  };
  
  adminData.matches.push(match);
  saveData();
  loadMatches();
  hideScheduleMatchModal();
  logActivity('Scheduled new match', 'success');
  
  // Clear form
  document.getElementById('matchDate').value = '';
  document.getElementById('matchTime').value = '';
  document.getElementById('matchVenue').value = '';
}

function generateFixtures() {
  const tournamentId = prompt('Enter tournament ID to generate fixtures:');
  const tournament = adminData.tournaments.find(t => t.id === parseInt(tournamentId));
  
  if (!tournament) {
    alert('Tournament not found');
    return;
  }
  
  const teams = adminData.teams.filter(t => t.tournamentId === tournament.id);
  
  if (teams.length < 2) {
    alert('Need at least 2 teams to generate fixtures');
    return;
  }
  
  let fixtures = [];
  let round = 1;
  
  // Simple round-robin generation
  for (let i = 0; i < teams.length; i++) {
    for (let j = i + 1; j < teams.length; j++) {
      const matchDate = new Date();
      matchDate.setDate(matchDate.getDate() + round);
      
      fixtures.push({
        id: Date.now() + fixtures.length,
        tournamentId: tournament.id,
        homeTeamId: teams[i].id,
        awayTeamId: teams[j].id,
        date: matchDate.toISOString().split('T')[0],
        time: '15:00',
        venue: `${teams[i].name} Stadium`,
        status: 'scheduled',
        homeScore: 0,
        awayScore: 0,
        round: round
      });
      
      if (tournament.settings.homeAndAway) {
        const returnDate = new Date(matchDate);
        returnDate.setDate(returnDate.getDate() + 7);
        
        fixtures.push({
          id: Date.now() + fixtures.length + 1000,
          tournamentId: tournament.id,
          homeTeamId: teams[j].id,
          awayTeamId: teams[i].id,
          date: returnDate.toISOString().split('T')[0],
          time: '15:00',
          venue: `${teams[j].name} Stadium`,
          status: 'scheduled',
          homeScore: 0,
          awayScore: 0,
          round: round + 1
        });
      }
    }
    round++;
  }
  
  fixtures.forEach(fixture => adminData.matches.push(fixture));
  saveData();
  loadMatches();
  logActivity(`Generated fixtures for ${tournament.name}`, 'success');
  alert(`Generated ${fixtures.length} fixtures for ${tournament.name}`);
}

function showMatchType(type) {
  const tabs = document.querySelectorAll('.admin-tab');
  tabs.forEach(tab => tab.classList.remove('active'));
  event.target.classList.add('active');
  loadMatches(type);
}

function loadMatches(type = 'upcoming') {
  let filteredMatches = adminData.matches;
  
  if (type === 'upcoming') {
    filteredMatches = adminData.matches.filter(m => m.status === 'scheduled');
  } else if (type === 'live') {
    filteredMatches = adminData.matches.filter(m => m.status === 'live');
  } else if (type === 'completed') {
    filteredMatches = adminData.matches.filter(m => m.status === 'completed');
  }
  
  const container = document.getElementById('matchesList');
  container.innerHTML = filteredMatches.map(match => {
    const homeTeam = adminData.teams.find(t => t.id === match.homeTeamId);
    const awayTeam = adminData.teams.find(t => t.id === match.awayTeamId);
    const tournament = adminData.tournaments.find(t => t.id === match.tournamentId);
    
    const statusBadge = match.status === 'scheduled' ? 'badge-warning' :
                       match.status === 'live' ? 'badge-success' :
                       match.status === 'completed' ? 'badge-info' : 'badge-danger';
    
    return `
      <tr>
        <td>${match.id}</td>
        <td>
          <div class="d-flex align-center gap-2">
            <div style="width: 20px; height: 20px; background: ${homeTeam?.color || '#ccc'}; border-radius: 4px;"></div>
            ${homeTeam?.name || 'Home'} vs
            <div style="width: 20px; height: 20px; background: ${awayTeam?.color || '#ccc'}; border-radius: 4px;"></div>
            ${awayTeam?.name || 'Away'}
          </div>
        </td>
        <td>${match.date} ${match.time}</td>
        <td>${match.venue}</td>
        <td><span class="admin-badge ${statusBadge}">${match.status}</span></td>
        <td>${match.homeScore} - ${match.awayScore}</td>
        <td>
          <button class="admin-btn" onclick="editMatch(${match.id})">
            <i class="fas fa-edit"></i>
          </button>
          <button class="admin-btn btn-danger" onclick="deleteMatchFromList(${match.id})">
            <i class="fas fa-trash"></i>
          </button>
          ${match.status === 'scheduled' ? `
            <button class="admin-btn btn-success" onclick="startMatch(${match.id})">
              <i class="fas fa-play"></i>
            </button>
          ` : ''}
        </td>
      </tr>
    `;
  }).join('');
}

// Points Management
function loadPointsTable() {
  const tournamentId = document.getElementById('pointsTournament').value;
  if (!tournamentId) return;
  
  const teams = adminData.teams.filter(t => t.tournamentId === parseInt(tournamentId));
  
  // Sort teams by points, GD, GF
  const sortedTeams = [...teams].sort((a, b) => {
    if (b.stats.points !== a.stats.points) return b.stats.points - a.stats.points;
    if ((b.stats.goalsFor - b.stats.goalsAgainst) !== (a.stats.goalsFor - a.stats.goalsAgainst)) 
      return (b.stats.goalsFor - b.stats.goalsAgainst) - (a.stats.goalsFor - a.stats.goalsAgainst);
    return b.stats.goalsFor - a.stats.goalsFor;
  });
  
  const container = document.getElementById('pointsTable');
  container.innerHTML = sortedTeams.map((team, index) => {
    return `
      <tr>
        <td>${index + 1}</td>
        <td><strong>${team.name}</strong></td>
        <td>${team.stats.played}</td>
        <td>${team.stats.won}</td>
        <td>${team.stats.drawn}</td>
        <td>${team.stats.lost}</td>
        <td>${team.stats.goalsFor}</td>
        <td>${team.stats.goalsAgainst}</td>
        <td>${team.stats.goalsFor - team.stats.goalsAgainst}</td>
        <td><strong>${team.stats.points}</strong></td>
        <td>
          <button class="admin-btn" onclick="adjustTeamPoints(${team.id})">
            <i class="fas fa-edit"></i> Adjust
          </button>
        </td>
      </tr>
    `;
  }).join('');
}

function adjustTeamStats() {
  const teamId = document.getElementById('adjustTeam').value;
  const points = parseInt(document.getElementById('adjustPoints').value);
  const gf = parseInt(document.getElementById('adjustGF').value);
  const wins = parseInt(document.getElementById('adjustWins').value);
  const draws = parseInt(document.getElementById('adjustDraws').value);
  const losses = parseInt(document.getElementById('adjustLosses').value);
  
  const team = adminData.teams.find(t => t.id === parseInt(teamId));
  if (!team) {
    alert('Team not found');
    return;
  }
  
  team.stats.points += points;
  team.stats.goalsFor += gf;
  team.stats.won += wins;
  team.stats.drawn += draws;
  team.stats.lost += losses;
  
  // Recalculate played matches
  team.stats.played = team.stats.won + team.stats.drawn + team.stats.lost;
  
  saveData();
  loadPointsTable();
  loadTeams();
  logActivity(`Adjusted stats for ${team.name}`, 'warning');
  alert(`Stats adjusted for ${team.name}`);
}

// Match Editing
function editMatch(matchId) {
  currentEditingMatchId = matchId;
  const match = adminData.matches.find(m => m.id === matchId);
  
  if (match) {
    document.getElementById('editHomeScore').value = match.homeScore;
    document.getElementById('editAwayScore').value = match.awayScore;
    document.getElementById('editMatchStatus').value = match.status;
    document.getElementById('editMatchModal').classList.remove('hidden');
  }
}

function closeEditModal() {
  document.getElementById('editMatchModal').classList.add('hidden');
  currentEditingMatchId = null;
}

function saveMatchResult() {
  if (!currentEditingMatchId) return;
  
  const homeScore = parseInt(document.getElementById('editHomeScore').value) || 0;
  const awayScore = parseInt(document.getElementById('editAwayScore').value) || 0;
  const status = document.getElementById('editMatchStatus').value;
  
  const match = adminData.matches.find(m => m.id === currentEditingMatchId);
  if (!match) return;
  
  // Update match
  match.homeScore = homeScore;
  match.awayScore = awayScore;
  match.status = status;
  match.updatedAt = new Date().toISOString();
  
  // Update team stats if match is completed
  if (status === 'completed') {
    updateTeamStats(match);
  }
  
  saveData();
  loadMatches();
  loadTeams();
  loadPointsTable();
  closeEditModal();
  logActivity(`Updated match result: ${homeScore}-${awayScore}`, 'success');
}

function updateTeamStats(match) {
  const homeTeam = adminData.teams.find(t => t.id === match.homeTeamId);
  const awayTeam = adminData.teams.find(t => t.id === match.awayTeamId);
  
  if (!homeTeam || !awayTeam) return;
  
  // Update matches played
  homeTeam.stats.played++;
  awayTeam.stats.played++;
  
  // Update goals
  homeTeam.stats.goalsFor += match.homeScore;
  homeTeam.stats.goalsAgainst += match.awayScore;
  awayTeam.stats.goalsFor += match.awayScore;
  awayTeam.stats.goalsAgainst += match.homeScore;
  
  // Update points based on result
  if (match.homeScore > match.awayScore) {
    homeTeam.stats.won++;
    awayTeam.stats.lost++;
    homeTeam.stats.points += 3;
  } else if (match.homeScore < match.awayScore) {
    awayTeam.stats.won++;
    homeTeam.stats.lost++;
    awayTeam.stats.points += 3;
  } else {
    homeTeam.stats.drawn++;
    awayTeam.stats.drawn++;
    homeTeam.stats.points += 1;
    awayTeam.stats.points += 1;
  }
}

function deleteMatchFromList(matchId) {
  if (confirm('Are you sure you want to delete this match?')) {
    adminData.matches = adminData.matches.filter(m => m.id !== matchId);
    saveData();
    loadMatches();
    logActivity('Deleted match', 'error');
  }
}

// Delete functions
function deleteTournament(id) {
  if (confirm('Delete this tournament? This will also delete all associated teams and matches.')) {
    adminData.tournaments = adminData.tournaments.filter(t => t.id !== id);
    adminData.teams = adminData.teams.filter(t => t.tournamentId !== id);
    adminData.matches = adminData.matches.filter(m => m.tournamentId !== id);
    saveData();
    loadTournaments();
    loadTeams();
    loadMatches();
    logActivity('Deleted tournament and all related data', 'error');
  }
}

function deleteTeam(id) {
  if (confirm('Delete this team?')) {
    adminData.teams = adminData.teams.filter(t => t.id !== id);
    adminData.players = adminData.players.filter(p => p.teamId !== id);
    adminData.matches = adminData.matches.filter(m => 
      m.homeTeamId !== id && m.awayTeamId !== id
    );
    saveData();
    loadTeams();
    loadPlayers();
    loadMatches();
    logActivity('Deleted team', 'error');
  }
}

function deletePlayer(id) {
  if (confirm('Delete this player?')) {
    adminData.players = adminData.players.filter(p => p.id !== id);
    saveData();
    loadPlayers();
    logActivity('Deleted player', 'error');
  }
}

// Registration Link
function generateRegistrationLink() {
  const baseUrl = window.location.origin + window.location.pathname;
  const token = btoa(`register_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`);
  const link = `${baseUrl}?register=admin&token=${token}`;
  
  document.getElementById('regLink').value = link;
  document.getElementById('registrationLinkModal').classList.remove('hidden');
}

function copyRegistrationLink() {
  const link = document.getElementById('regLink');
  link.select();
  document.execCommand('copy');
  alert('Link copied to clipboard!');
}

function hideRegistrationLink() {
  document.getElementById('registrationLinkModal').classList.add('hidden');
}

// Populate Selects
function populateTournamentSelect(selectId) {
  const select = document.getElementById(selectId);
  if (!select) return;
  
  select.innerHTML = '<option value="">Select Tournament</option>';
  adminData.tournaments.forEach(tournament => {
    select.innerHTML += `<option value="${tournament.id}">${tournament.name}</option>`;
  });
}

function populateTeamsSelect(selectId) {
  const select = document.getElementById(selectId);
  if (!select) return;
  
  select.innerHTML = '<option value="">Select Team</option>';
  adminData.teams.forEach(team => {
    select.innerHTML += `<option value="${team.id}">${team.name}</option>`;
  });
}

// System Functions
function resetSystem() {
  if (confirm('WARNING: This will delete ALL data. Are you sure?')) {
    adminData = {
      tournaments: [],
      teams: [],
      players: [],
      matches: [],
      activityLog: [],
      users: [],
      settings: {
        adminPassword: ADMIN_PASSWORD,
        registrationOpen: true,
        maxTeams: 32,
        maxPlayersPerTeam: 25
      }
    };
    saveData();
    init();
    logActivity('System reset to default', 'warning');
    alert('System reset complete');
  }
}

function refreshStats() {
  updateStats();
  updateActivityLog();
  logActivity('Stats refreshed', 'info');
}

// Create Sample Data
function createSampleData() {
  // Create sample tournament
  const sampleTournament = {
    id: 1,
    name: "Premier League 2024",
    type: "league",
    status: "ongoing",
    currentRound: 19,
    settings: {
      totalTeams: 20,
      fixtureGen: "auto",
      homeAndAway: true,
      pointsPerWin: 3,
      pointsPerDraw: 1,
      pointsPerLoss: 0
    },
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString()
  };
  
  adminData.tournaments.push(sampleTournament);
  
  // Create sample teams
  const sampleTeams = [
    { id: 1, name: "Arsenal", shortCode: "ARS", color: "#EF0107" },
    { id: 2, name: "Manchester City", shortCode: "MCI", color: "#6CABDD" },
    { id: 3, name: "Liverpool", shortCode: "LIV", color: "#C8102E" },
    { id: 4, name: "Chelsea", shortCode: "CHE", color: "#034694" },
    { id: 5, name: "Manchester United", shortCode: "MUN", color: "#DA291C" }
  ];
  
  sampleTeams.forEach(team => {
    team.tournamentId = 1;
    team.stats = {
      played: 19,
      won: Math.floor(Math.random() * 15),
      drawn: Math.floor(Math.random() * 10),
      lost: Math.floor(Math.random() * 10),
      goalsFor: Math.floor(Math.random() * 50),
      goalsAgainst: Math.floor(Math.random() * 30),
      points: Math.floor(Math.random() * 50)
    };
    adminData.teams.push(team);
  });
  
  // Create sample players
  const samplePlayers = [
    { id: 1, name: "Erling Haaland", email: "haaland@efootball.com", teamId: 2, position: "forward", stats: { matches: 19, goals: 18, assists: 5, yellowCards: 1, redCards: 0 }, rating: 8.2 },
    { id: 2, name: "Mohamed Salah", email: "salah@efootball.com", teamId: 3, position: "forward", stats: { matches: 19, goals: 14, assists: 8, yellowCards: 2, redCards: 0 }, rating: 7.9 },
    { id: 3, name: "Bukayo Saka", email: "saka@efootball.com", teamId: 1, position: "midfielder", stats: { matches: 19, goals: 10, assists: 9, yellowCards: 3, redCards: 0 }, rating: 7.8 }
  ];
  
  samplePlayers.forEach(player => adminData.players.push(player));
  
  // Create sample matches
  const sampleMatches = [
    { id: 1, tournamentId: 1, homeTeamId: 1, awayTeamId: 2, date: "2024-01-15", time: "15:00", venue: "Emirates Stadium", status: "completed", homeScore: 3, awayScore: 1, round: 1 },
    { id: 2, tournamentId: 1, homeTeamId: 3, awayTeamId: 4, date: "2024-01-15", time: "17:30", venue: "Anfield", status: "completed", homeScore: 2, awayScore: 2, round: 1 },
    { id: 3, tournamentId: 1, homeTeamId: 1, awayTeamId: 3, date: "2024-01-22", time: "15:00", venue: "Emirates Stadium", status: "scheduled", homeScore: 0, awayScore: 0, round: 2 }
  ];
  
  sampleMatches.forEach(match => adminData.matches.push(match));
  
  saveData();
  logActivity('Sample data created', 'info');
}

// Initialize on load
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
